<!DOCTYPE html><html><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="/component---src-layouts-index-js-998b6983a18c6bc3d993.js" as="script"/><link rel="preload" href="/component---src-templates-blog-post-js-eaa57329290e13f78bcb.js" as="script"/><link rel="preload" href="/path---polygon-test-09768f078ff50d4e3726.js" as="script"/><link rel="preload" href="/app-b8796d719d54f8bc33a3.js" as="script"/><link rel="preload" href="/commons-d41d8cd98f00b204e980.js" as="script"/><title data-react-helmet="true">Your Blog Name - Python Example for Point-in-Polygon data</title><meta data-react-helmet="true" name="description" content="Sample"/><meta data-react-helmet="true" name="keywords" content="sample, something"/><style id="gatsby-inlined-css">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.45em georgia,serif;box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:rgba(0,0,0,.8);font-family:georgia,serif;font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";-webkit-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt","kern"}img{max-width:100%;margin:0 0 1.45rem;padding:0}h1{font-size:2.25rem}h1,h2{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{margin:0 0 1.45rem;padding:0}ol,ul{margin:0 0 1.45rem 1.45rem;padding:0;list-style-position:outside;list-style-image:none}dd,dl,figure,p{margin:0 0 1.45rem;padding:0}pre{padding:0;font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}pre,table{margin:0 0 1.45rem}table{padding:0;font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset{margin:0 0 1.45rem;padding:0}blockquote{margin:0 1.45rem 1.45rem;padding:0}form,iframe,noscript{margin:0 0 1.45rem;padding:0}hr{margin:0 0 calc(1.45rem - 1px);padding:0;background:rgba(0,0,0,.2);border:none;height:1px}address{margin:0 0 1.45rem;padding:0}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:0;padding-top:.2em;padding-bottom:.2em}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}</style></head><body><div id="___gatsby"><div data-reactroot="" data-reactid="1" data-react-checksum="2054671201"><!-- react-empty: 2 --><div style="background:rebeccapurple;margin-bottom:1.45rem;" data-reactid="3"><div style="margin:0 auto;max-width:960px;padding:1.45rem 1.0875rem;" data-reactid="4"><h1 style="margin:0;" data-reactid="5"><a style="color:white;text-decoration:none;" href="/" data-reactid="6">Gatsby</a></h1></div></div><div style="margin:0 auto;max-width:960px;padding:0px 1.0875rem 1.45rem;padding-top:0;" data-reactid="7"><div class="blog-post-container" data-reactid="8"><!-- react-empty: 9 --><div class="blog-post" data-reactid="10"><h1 data-reactid="11">Python Example for Point-in-Polygon data</h1><div class="blog-post-content" data-reactid="12"><p><a href="http://geoffboeing.com/2014/09/using-geopandas-windows/">Using geopandas on Windows</a>
<a href="https://gist.github.com/gboeing/a6fcb39a9010d142446f4a83e43d8d6c">GitHub gist</a></p>
<p>Follow instructions here:</p>
<p>Notes:</p>
<ul>
<li>I called my conda environment geopandas27 - and used Python 2.7</li>
<li>I added openpyxl - this is the module used to open and parse Excel files - If you were reading CSV or SQL you would use other modules like csv, psyproj or SQL sqlalchemy .</li>
<li>As I am documenting the setup and revisiting the code I am taking opportunities to make the code easier to use and understand but it's still hacky. Let's see if we can help each other make this code sharable with a wider audience.</li>
</ul>
<p><a href="https://www.microsoft.com/en-us/download/details.aspx?id=44266">Install Microsoft Visual C++ Compiler for Python 2.7</a></p>
<p>Create a new environment for geopandas</p>
<p>`conda create -n geopandas27 python=2 anaconda-client pywin32 psutil numexpr cython pytables sqlalchemy statsmodels bottleneck xlrd xlwt pillow matplotlib pandas scikit-learn jupyter requests networkx</p>
<p>activate geopandas27</p>
<p>pip install Rtree-0.8.3-cp27-cp27m-win<em>amd64.whl basemap-1.1.0-cp27-cp27m-win</em>amd64.whl GDAL-2.2.3-cp27-cp27m-win<em>amd64.whl Shapely-1.6.2-cp27-cp27m-win</em>amd64.whl Fiona-1.7.10-cp27-cp27m-win<em>amd64.whl pyproj-1.9.5.1-cp27-cp27m-win</em>amd64.whl geopy descartes geopandas osmnx openpyxl
`</p>
<p>If the environment installs without error your should be able to run the Point in polygon script:</p>
<p>Notes:</p>
<ul>
<li>Assumes Project Data for Rural Eligibility Analysis.xlsx is on local directory</li>
<li>Assumes shape file and related spatial files are in the local directory</li>
<li>Script will create a test.csv output file</li>
<li>It stakes a few seconds to open the Excel file then a few seconds for each phase of processing the data</li>
<li>An important step in joining the spatial data polygon file to the point data is transforming the point lat/longs to the same projection as the polygon projection. This is done using pyProj. If you have a different shape fie in a different projection the transform will need to change. See <a href="https://gis.stackexchange.com/questions/78838/converting-projected-coordinates-to-lat-lon-using-python">https://gis.stackexchange.com/questions/78838/converting-projected-coordinates-to-lat-lon-using-python</a> for some useful details and <a href="https://jswhit.github.io/pyproj/">https://jswhit.github.io/pyproj/</a>. I have made the code a bit more general by reading the crs from the shape file and assuming the data file is in EPSG:4326. See <a href="https://gis.stackexchange.com/questions/3334/what-is-the-difference-between-wgs84-and-epsg4326">https://gis.stackexchange.com/questions/3334/what-is-the-difference-between-wgs84-and-epsg4326</a> fopr some background about the relationship between WGS84 and EPSG:4326 and <a href="https://en.wikipedia.org/wiki/Spatial_reference_system">https://en.wikipedia.org/wiki/Spatial<em>reference</em>system</a> for more general information about Spatial Reference Systems</li>
<li>If you want to modify this script to work with different point files and different polygon shape files it should not be that hard. Indeed testing with different data sets would be a great way to learn how to generalise the approach. We could also compare it to the in database approach.</li>
</ul>
<p><code>python point_in_sfh_mfh_ineligible.py</code></p></div></div></div></div></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-b8796d719d54f8bc33a3.js","107818501498521":"component---src-templates-blog-post-js-eaa57329290e13f78bcb.js","35783957827783":"component---src-pages-index-js-45d9095ded31735c0554.js","60335399758886":"path----557518bd178906f8d58a.js","75153307507173":"path---script-kiddie-e42993f1d4a0e6d291d3.js","140559286549901":"path---polygon-test-09768f078ff50d4e3726.js","133522796427265":"path---mermaid-6e7a9179650d81aff3bb.js","144342403179678":"path---hello-world-8e4fe07e2170bccf715c.js","142629428675168":"path---index-373f86ff7da479005cd3.js","114276838955818":"component---src-layouts-index-js-998b6983a18c6bc3d993.js"}/*]]>*/</script><script>/*<![CDATA[*/!function(e,t,r){function n(){for(;d[0]&&"loaded"==d[0][f];)c=d.shift(),c[o]=!i.parentNode.insertBefore(c,i)}for(var s,a,c,d=[],i=e.scripts[0],o="onreadystatechange",f="readyState";s=r.shift();)a=e.createElement(t),"async"in i?(a.async=!1,e.head.appendChild(a)):i[f]?(d.push(a),a[o]=n):e.write("<"+t+' src="'+s+'" defer></'+t+">"),a.src=s}(document,"script",["/commons-d41d8cd98f00b204e980.js","/app-b8796d719d54f8bc33a3.js","/path---polygon-test-09768f078ff50d4e3726.js","/component---src-templates-blog-post-js-eaa57329290e13f78bcb.js","/component---src-layouts-index-js-998b6983a18c6bc3d993.js"])/*]]>*/</script></body></html>